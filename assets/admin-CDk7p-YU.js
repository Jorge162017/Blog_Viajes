import{r as o,j as e,P as i,u as k,L as E}from"./index-CGDC2yk-.js";function P(){const l=k(),[d,m]=o.useState(""),[r,s]=o.useState(""),[u,g]=o.useState(""),[b,h]=o.useState(""),j=()=>{localStorage.removeItem("token"),l("/")},c=(t,n)=>n(t.target.value),x=async t=>{t.preventDefault();try{const n=await fetch("http://44.202.104.77/api/22103/post",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({title:d,img:r,content:u,author:b})});n.ok?console.log("Post creado con éxito"):console.error("Error al crear post",n.statusText)}catch(n){console.error("Error en la red al crear post",n)}};return e.jsx("header",{children:e.jsxs("nav",{className:"navbar navbar-expand-lg navbar-dark bg-primary",children:[e.jsx("h1",{className:"navbar-brand",href:"#",children:"BLOG DE VIAJES"}),e.jsxs("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:[e.jsx("ul",{className:"navbar-nav mr-auto",children:e.jsxs("li",{className:"nav-item active",children:[e.jsx("button",{type:"button",className:"btn btn-light","data-bs-toggle":"modal","data-bs-target":"#exampleModal3","data-bs-whatever":"@getbootstrap",children:"New Post +"}),e.jsx("div",{className:"modal fade",id:"exampleModal3",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"exampleModalLabel",children:"New Post"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"title",className:"col-form-label",children:"Title:"}),e.jsx("input",{type:"text",className:"form-control",id:"title",value:d,onChange:t=>c(t,m)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"image-address",className:"col-form-label",children:"Image Address:"}),e.jsx("input",{type:"text",className:"form-control",id:"image-address",value:r,onChange:t=>c(t,s)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"description",className:"col-form-label",children:"Description:"}),e.jsx("textarea",{className:"form-control",id:"description",value:u,onChange:t=>c(t,g)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"image-address",className:"col-form-label",children:"Author:"}),e.jsx("input",{type:"text",className:"form-control",id:"image-address",value:b,onChange:t=>c(t,h)})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Post"})]})]})})]})})})]})}),e.jsx("form",{className:"form-inline my-2 my-lg-0",children:e.jsx(E,{to:"/",className:"nav-link",children:e.jsx("button",{onClick:j,className:"btn btn-danger",type:"submit",children:"Log Out"})})})]})]})})}function y({post:l}){const d={backgroundColor:"#edede9",border:"1px solid #000",margin:"10px auto",display:"flex",alignItems:"center",maxWidth:"800px",padding:"10px"},m={width:"50%",marginRight:"10px"},[r,s]=o.useState(!1),[u,g]=o.useState(null),b=a=>{console.log("Estableciendo postIdToDelete a:",a),g(a),s(!0)},h=()=>s(!1),j=()=>{fetch(`http://44.202.104.77/api/22103/post/${u}`,{method:"DELETE"}).then(a=>{console.log("Respuesta de la solicitud DELETE:",a),a.ok?h():console.error("Error al eliminar el post:",a.statusText)}).catch(a=>{console.error("Error al eliminar el post:",a)})},[c,x]=o.useState(!1),[t,n]=o.useState(null),f=a=>{console.log("Estableciendo post actual a:",a),n(a),x(!0)},N=()=>x(!1),p=(a,v)=>{n(S=>({...S,[v]:a.target.value}))},C=async()=>{try{const a=await fetch(`http://44.202.104.77/api/22103/post/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({title:t.title,img:t.img,content:t.content,author:t.author})});if(a.ok)console.log("Post actualizado con éxito"),N();else{const v=await a.json();console.error("Error al actualizar post",v)}}catch(a){console.error("Error en la red al actualizar post",a)}};return e.jsxs("div",{className:"card",style:d,children:[e.jsx("h3",{className:"card-title",children:l.title}),e.jsx("img",{src:l.img,alt:l.title,style:m}),e.jsx("p",{className:"card-text",children:l.content}),e.jsxs("p",{className:"card-author",children:["Autor: ",l.author]}),e.jsxs("div",{children:[e.jsx("button",{type:"button",className:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#exampleModal","data-bs-whatever":"@getbootstrap",style:{margin:"0 20px 0  0"},onClick:()=>f(l),children:"Update"}),c&&e.jsx("div",{className:"modal fade show",style:{display:"block"},"aria-modal":"true",role:"dialog",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Update Post"}),e.jsx("button",{type:"button",className:"btn-close",onClick:N})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"col-form-label",children:"Title:"}),e.jsx("input",{type:"text",className:"form-control",value:t.title,onChange:a=>p(a,"title")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"col-form-label",children:"Image address:"}),e.jsx("input",{type:"text",className:"form-control",value:t.img,onChange:a=>p(a,"img")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"col-form-label",children:"Description:"}),e.jsx("textarea",{className:"form-control",value:t.content,onChange:a=>p(a,"content")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"col-form-label",children:"Author:"}),e.jsx("input",{type:"text",className:"form-control",value:t.author,onChange:a=>p(a,"author")})]})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:N,children:"Close"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:C,children:"Update"})]})]})})}),e.jsx("button",{type:"button",className:"btn btn-danger","data-bs-toggle":"modal","data-bs-target":"#exampleModal2",onClick:()=>b(l.id),children:"Delete"}),r&&e.jsx("div",{className:"modal fade show",style:{display:"block"},"aria-modal":"true",role:"dialog",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Delete Post"}),e.jsx("button",{type:"button",className:"btn-close",onClick:h})]}),e.jsx("div",{className:"modal-body",children:"Are you sure you want to delete this post?"}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:h,children:"Back"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:j,children:"Delete"})]})]})})})]})]})}function T(){const[l,d]=o.useState([]),[m,r]=o.useState(!1);return o.useEffect(()=>{r(!0),fetch("http://44.202.104.77/api/22103/post").then(s=>s.json()).then(s=>{d(s),r(!1)}).catch(s=>{console.error("Error al cargar los datos de la API:",s),r(!1)})},[]),e.jsxs("div",{children:[e.jsx(P,{}),m?e.jsx("div",{children:"Loading..."}):l.map(s=>e.jsx(y,{post:s},s.id))]})}y.propTypes={post:i.shape({id:i.number.isRequired,title:i.string.isRequired,img:i.string.isRequired,content:i.string.isRequired,author:i.string.isRequired}).isRequired};export{T as default};
